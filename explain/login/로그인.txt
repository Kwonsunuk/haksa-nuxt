ë¸Œë¼ìš°ì €->>í”„ë¡ íŠ¸: ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥ (ID, PW)
  í”„ë¡ íŠ¸->>ë°±ì—”ë“œ: POST /api/auth/login
  ë°±ì—”ë“œ->>DB: student_idë¡œ ìœ ì € ì¡°íšŒ
  DB-->>ë°±ì—”ë“œ: ìœ ì € ì •ë³´ + ì•”í˜¸í™” PW
  ë°±ì—”ë“œ->>ë°±ì—”ë“œ: bcrypt ë¹„êµ, JWT ìƒì„±
  ë°±ì—”ë“œ-->>í”„ë¡ íŠ¸: token + student info
  í”„ë¡ íŠ¸->>ë¡œì»¬ìŠ¤í† ë¦¬ì§€/ì¿ í‚¤: token ì €ì¥
  ë¸Œë¼ìš°ì €->>í”„ë¡ íŠ¸: ìƒˆë¡œê³ ì¹¨
  í”„ë¡ íŠ¸->>plugins/fetchMe: ì¿ í‚¤ì—ì„œ í† í° ì½ìŒ
  fetchMe->>ë°±ì—”ë“œ: GET /api/auth/me
  ë°±ì—”ë“œ->>ë°±ì—”ë“œ: JWT í† í° ê²€ì¦
  ë°±ì—”ë“œ-->>í”„ë¡ íŠ¸: student info
  í”„ë¡ íŠ¸-->>í™”ë©´: ë¡œê·¸ì¸ëœ ìƒíƒœ ë Œë”ë§

***ì‹¤í–‰ íë¦„***

ğŸ”¸ ê´€ë ¨ íŒŒì¼
plugins/fetchMe.client.js

stores/userStore.js

(1) Nuxt ì•±ì´ ì‹¤í–‰ë˜ë©´
[â†’ fetchMe.client.jsê°€ ìë™ ì‹¤í–‰ë¨ (Nuxtì˜ client-side plugin)]

(2) fetchMe.client.js ë‚´ë¶€ ë¡œì§
[
const userStore = useUserStore();

if (userStore.me) return; // ì´ë¯¸ ë¡œê·¸ì¸ ìƒíƒœë©´ ì•„ë¬´ ì‘ì—… ì•ˆ í•¨

const tokenCookie = useCookie('token'); // JWT í† í°ì„ ì¿ í‚¤ì—ì„œ í™•ì¸
if (tokenCookie.value) {
  await userStore.fetchMe(); // í† í°ì´ ìˆìœ¼ë©´ ì‚¬ìš©ì ìƒíƒœ ë³µì› ì‹œë„
}
]

(3) userStore.fetchMe() í˜¸ì¶œ â†’ stores/userStore.js ë‚´ë¶€ë¡œ ì´ë™
[
async function fetchMe() {
  isFetching.value = true; // ë¡œë”© ìƒíƒœ ì‹œì‘

  // SSR ë‹¨ê³„ì—ì„œ windowê°€ ì—†ìœ¼ë¯€ë¡œ ë¬´ì‹œ
  if (typeof window === 'undefined') {
    isFetching.value = false;
    return;
  }

  // ì¿ í‚¤ì—ì„œ ì €ì¥ëœ í† í° ê°€ì ¸ì˜´
  const tokenCookie = useCookie('token');
  const savedToken = tokenCookie.value;

  if (!savedToken) {
    logout(); // í† í° ì—†ìœ¼ë©´ ë¡œê·¸ì•„ì›ƒ
    isFetching.value = false;
    return;
  }

  // ë°±ì—”ë“œë¡œ ì¸ì¦ ìš”ì²­ ë³´ëƒ„
  const response = await fetch('http://localhost:4000/api/auth/me', {
    headers: {
      Authorization: `Bearer ${savedToken}`, // JWTë¥¼ Bearer ì¸ì¦ ë°©ì‹ìœ¼ë¡œ ì „ì†¡
    },
  });

  // ì‘ë‹µì´ ì„±ê³µì´ë¼ë©´ ì‚¬ìš©ì ì •ë³´ ì €ì¥
  if (response.ok) {
    const data = await response.json();
    me.value = data.student; // ì‚¬ìš©ì ì •ë³´ ì €ì¥
    token.value = savedToken; // í† í° ì¬ì§€ì •
  } else {
    logout(); // ì‹¤íŒ¨ ì‹œ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
  }

  isFetching.value = false;
}

]

[Nuxt ì•± ì‹¤í–‰ ì‹œ] 
â†’ plugins/fetchMe.client.js ìë™ ì‹¤í–‰

â†’ userStore.meê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
  â”” ìˆìœ¼ë©´ ì•„ë¬´ê²ƒë„ ì•ˆ í•¨ (ì´ë¯¸ ë¡œê·¸ì¸ ìƒíƒœ)

â†’ ì—†ìœ¼ë©´ useCookie('token')ìœ¼ë¡œ ì¿ í‚¤ì—ì„œ JWT í† í° ê°€ì ¸ì˜´
  â”” ì—†ìœ¼ë©´ fetchMe ì¢…ë£Œ â†’ ë¡œê·¸ì¸ ìƒíƒœ ì•„ë‹˜
  â”” ìˆìœ¼ë©´ userStore.fetchMe() ì‹¤í–‰í•˜ì—¬ ìƒíƒœ ë³µì› ì‹œë„

â†’ fetchMe() ë‚´ë¶€ì—ì„œ ë°±ì—”ë“œ API /api/auth/me í˜¸ì¶œ
  â”” Authorization: Bearer <token> í—¤ë” í¬í•¨

â†’ ì‘ë‹µì´ ì„±ê³µì´ë©´ userStore.meì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
  â”” ì´í›„ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì—ì„œ userStore.me ì‚¬ìš© ê°€ëŠ¥


***ìœ ì €ê°€ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­***

ğŸ”¸ ê´€ë ¨ íŒŒì¼
components/LoginForm.vue
stores/userStore.js
controllers/authController.js
models/userModel.js

(1) ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ â†’ LoginForm.vue

[
<form @submit.prevent="login">
  <input v-model="student_id" />
  <input v-model="password" type="password" />
  <button type="submit">ë¡œê·¸ì¸</button>
</form>

async function login() {
  await userStore.login(student_id.value, password.value);
  router.push('/schedule');
}
]

(2) login() í•¨ìˆ˜ ì‹¤í–‰ â†’ stores/userStore.js
[
async function login(student_id, password) {
  // student_idì™€ passwordë¥¼ JSON í˜•ì‹ìœ¼ë¡œ POST ì „ì†¡í•œë‹¤.
  const response = await fetch('http://localhost:4000/api/auth/login', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json', // json í˜•ì‹ìœ¼ë¡œ ë°ì´í„° ì „ì†¡
    },
    body: JSON.stringify({
      // ì…ë ¥ëœ ê°’ì„ JSON í˜•ì‹ìœ¼ë¡œ ë³€í™˜
      student_id,
      password,
    }),
  });

  if (!response.ok) throw new Error('ë¡œê·¸ì¸ ì‹¤íŒ¨');

  // ì‘ë‹µ ìƒíƒœê°€ 200ì´ë©´ JSON í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì‚¬ìš©ì ì •ë³´ì™€ í† í°ì„ ì €ì¥í•œë‹¤.
  // JSON í˜•íƒœë¡œ ì‘ë‹µ ë°”ë””ë¥¼ íŒŒì‹±
  // ì‘ë‹µ ë°”ë””ëŠ” { student: { name: 'í™ê¸¸ë™', student_id: 'S20230001' }, token: 'JWT_TOKEN' } í˜•íƒœì´ë‹¤.
  const data = await response.json(); // âœ… token, student
  me.value = data.student;
  token.value = data.token;

  // âœ… í† í°ì„ ì¿ í‚¤ì™€ localStorageì— ì €ì¥
  useCookie('token').value = data.token;
  localStorage.setItem('token', data.token);
}
]

(3) ë°±ì—”ë“œë¡œ ì „ì†¡ëœ ìš”ì²­ â†’ /api/auth/login

ê²½ë¡œ íƒ€ê³  ë“¤ì–´ì˜¤ëŠ” ê³¼ì • -> server.jsì—ì„œ 
[
    import authRouter from './routes/auth.js';
    app.use('/api/auth', authRouter);
]
routes/auth.jsì—ì„œ /api/auth/loginê²½ë¡œê°€ ì™„ì„±ì´ ë¨.
[
    import express from 'express';
    import { login } from '../controllers/authController.js';

    const router = express.Router();
    router.post('/login', login); // ğŸ”¥ /api/auth/login ê²½ë¡œ ì™„ì„±
    export default router;
]
controllers/authController.jsë¡œ ì˜¤ê²Œ ë¨.

[
/**
 * ë¡œê·¸ì¸ ìš”ì²­ ì²˜ë¦¬
 * - ì‚¬ìš©ì í•™ë²ˆê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê²€ì¦í•˜ê³  JWT í† í°ì„ ë°œê¸‰
 */
export async function login(req, res) {
  const { student_id, password } = req.body;

  try {
    // 1. ì‚¬ìš©ì ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    const user = await findStudentById(student_id);
    if (!user) {
      return res.status(401).json({ message: 'ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ìì…ë‹ˆë‹¤.' });
    }

    // 2. ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸
    const isMatch = await bcrypt.compare(password, user.password);
    if (!isMatch) {
      return res.status(401).json({ message: 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' });
    }

    // 3. JWT í† í° ìƒì„±
    const token = jwt.sign(
      { student_id: user.student_id },
      process.env.JWT_SECRET,
      { expiresIn: '1d' } // í† í° ë§Œë£Œ: 1ì¼
    );

    // 4. ì‘ë‹µ ë°˜í™˜ (JWT + ì‚¬ìš©ì ì •ë³´)
    res.status(200).json({
      token,
      student: {
        student_id: user.student_id,
        name: user.name,
      },
    });
  } catch (err) {
    // ì˜ˆì™¸ ì²˜ë¦¬: ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜
    console.error('[authController/login] ì„œë²„ ì˜¤ë¥˜:', err);
    res.status(500).json({ message: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' });
  }
}
]

(4) ì‚¬ìš©ì ì •ë³´ + JWT í† í° ì‘ë‹µ â†’ í”„ë¡ íŠ¸ì—ì„œ ì¿ í‚¤ + localStorage ì €ì¥
[
â†’ ì¿ í‚¤ ì €ì¥: useCookie('token').value = token;
â†’ localStorage ì €ì¥: localStorage.setItem('token', token);
â†’ userStore.me = ì‚¬ìš©ì ì •ë³´ ì €ì¥ ì™„ë£Œ
â†’ í˜ì´ì§€ ì´ë™: router.push('/schedule');
]

ì •ë¦¬ëœ í•µì‹¬ íë¦„
â†’ ì¿ í‚¤ ì €ì¥: useCookie('token').value = token;
â†’ localStorage ì €ì¥: localStorage.setItem('token', token);
â†’ userStore.me = ì‚¬ìš©ì ì •ë³´ ì €ì¥ ì™„ë£Œ
â†’ í˜ì´ì§€ ì´ë™: router.push('/schedule');

ì™œ ì¿ í‚¤ë‘ localStorage ë‘˜ë‹¤ ì €ì¥ í–ˆëŠ”ê°€?
useCookie()ëŠ” Nuxt SSR í™˜ê²½ì—ì„œ ë¡œê·¸ì¸ ìƒíƒœ ë³µì› ê°€ëŠ¥
localStorageëŠ” í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ ìƒíƒœ ìœ ì§€ë¥¼ ìœ„í•´

[3] ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ì‹œë„ (LoginForm.vue)
ì…ë ¥ â†’ ì„œë²„ ìš”ì²­ â†’ í† í° & ì‚¬ìš©ì ì •ë³´ ì €ì¥

ğŸ“ í”„ë¡ íŠ¸
LoginForm.vue â†’ userStore.login() ì‹¤í–‰

stores/userStore.js:

fetch('/api/auth/login', { student_id, password })

ì‘ë‹µ ë°›ìœ¼ë©´:

me.value = user

token.value = token

localStorage.setItem('token', token)

useCookie('token').value = token

ğŸ“ ë°±ì—”ë“œ
routes/auth.js: /login â†’ authController.login() í˜¸ì¶œ

controllers/authController.js:

DBì—ì„œ student_id ì¡°íšŒ â†’ bcrypt ë¹„êµ

ì„±ê³µ ì‹œ jwt.sign()ìœ¼ë¡œ í† í° ë°œê¸‰ í›„ JSON ì‘ë‹µ



----------------------------------------------------
***Nuxt ì•± ìƒˆë¡œê³ ì¹¨ ì‹œ ë¡œê·¸ì¸ ìƒíƒœ ë³µì› íë¦„***
[
    [Nuxt ì•± ì‹¤í–‰ ì‹œ] â†’ plugins/fetchMe.client.js ìë™ ì‹¤í–‰
                â†’ useCookie('token')ìœ¼ë¡œ ì¿ í‚¤ì—ì„œ í† í° ì½ê¸°
                â†’ í† í°ì´ ì¡´ì¬í•˜ë©´ stores/userStore.jsì˜ fetchMe() í˜¸ì¶œ
                â†’ fetchMe() ë‚´ë¶€ì—ì„œ ì„œë²„ë¡œ ì¸ì¦ ìš”ì²­ (/api/auth/me)
                â†’ ì¸ì¦ ì„±ê³µ ì‹œ me ìƒíƒœì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
                â†’ ë¡œê·¸ì¸ ìƒíƒœ ë³µì› ì™„ë£Œ

]